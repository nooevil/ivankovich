#!/usr/bin/env node
import{exec as e,execSync as s}from"child_process";const t=(s,t)=>new Promise((o,n)=>{e(s,Object(t),(e,s,t)=>{e?n(t):o(s)})}),o=(e,s)=>Object.keys(Object(e)).concat(Object.keys(Object(s))).some(t=>e[t]!==s[t]);export default function(){Promise.all([t("git show ORIG_HEAD:package.json"),t("git show HEAD:package.json")]).then(e=>{const t=JSON.parse(e[0]),n=JSON.parse(e[1]);(o(t.dependencies,n.dependencies)||o(t.devDependencies,n.devDependencies))&&(s("npm install",{stdio:["pipe","pipe",process.stderr]}),console.log("Please restart the server."))},e=>{const s=/^fatal: Invalid object name/;if(!s.test(e))throw new Error(s)}).then(()=>process.exit(0),e=>{console.error(e),process.exit(1)})}
